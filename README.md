# Molecular Dynamics of Graphene-Water Interface

This repository contains tools and procedures to build and simulate a graphene-water interface using molecular dynamics (MD) methods with **xTB**, **GFN-FF**, **GFN2-xTB**, and **Packmol**.

## Table of Contents
- [Folder Structure](#folder-structure)  
- [Project Overview](#project-overview)  
- [Installation](#installation)  
- [Usage](#usage)  
- [Theoretical Background](#theoretical-background)  
- [Examples](#examples)  
- [Contribution](#contribution)  
- [License](#license)

---

## Project Overview

This project aims to simulate a realistic interface between a monolayer of **graphene** and multiple **water molecules**. The procedure includes:

- Constructing periodic graphene layers from benzene using **GaussView**
- Geometry optimization using **GFN-FF** with **xTB**
- Building molecular interfaces with **Packmol**
- Running **Molecular Dynamics simulations** with **GFN2-xTB**

The objective is to study the dynamics and interactions of water molecules over a graphene surface, a system of interest in fields such as material science, nanotechnology, and energy storage.

### Purpose

To provide a reproducible and documented framework for carrying out simulations of molecule-surface interfaces using open-source or free academic software.

### Features

- Graphene sheet generation with periodic boundary conditions (PBC)
- Interface creation with multiple water molecules using Packmol
- Support for geometry optimization and MD simulations via xTB (GFN-FF and GFN2-xTB)
- Includes example input files and configuration templates
- Atom separation tools for progressive MD analysis

---

## Folder Structure

```
graphene-water-interface/
│
├── input/                # Contains initial XYZ files for graphene and water
├── optimized/            # Stores optimized geometries (xtbopt.xyz)
├── md/                   # Contains MD parameter files (md.inp, mdrestart, etc.)
├── interface/            # Files generated by Packmol (interfaz.xyz)
├── scripts/              # Custom Python scripts for file manipulation
│   └── separar_aguas.py  # Script to separate water molecules into individual files
├── results/              # MD simulation outputs (xtb.trj, charges, etc.)
└── README.md             # This file
```

---

## Installation

### Requirements

- Python 3.x
- xTB (https://github.com/grimme-lab/xtb)
- Packmol (https://github.com/m3g/packmol)
- Visualization tools: Chemcraft, VMD, GaussView (optional)

### Setup

Install xTB and Packmol:

```bash
# xTB installation
git clone https://github.com/grimme-lab/xtb.git
cd xtb
mkdir build && cd build
cmake ..
make
sudo make install

# Packmol installation
sudo apt install gfortran
git clone https://github.com/m3g/packmol.git
cd packmol
make
sudo mv packmol /usr/local/bin/
```

---

## Usage

### 1. Build Graphene and Water Geometries

Generate graphene sheet using GaussView:
- Start from benzene
- Apply D6h symmetry
- Enable PBC (2D)
- Build and export as `.xyz`

Optimize geometries with xTB:
```bash
xtb water.xyz --opt --gfnff
xtb graphene.xyz --opt --gfnff
```

### 2. Create Interface with Packmol

Prepare an input file `inputfile.inp`, then run:
```bash
packmol < inputfile.inp
```

### 3. Separate Water Molecules

Use the script to create individual files:
```bash
python scripts/separar_aguas.py interfaz.xyz
```

### 4. Run MD Simulations

Set up `md.inp` with parameters and execute:
```bash
xtb coord.xyz --input md.inp --md
```

For restart:
```bash
xtb coord.xyz --input md.inp --md  # with `restart=true` in md.inp
```

---

## Theoretical Background

This work is based on methods using GFN-FF and GFN2-xTB force fields developed by Grimme’s group. It includes:

- Accurate handling of non-covalent interactions
- Simulation under NVT ensemble with adjustable parameters
- Periodic boundary conditions for extended systems

More information on the methods can be found in the documentation and at https://xtb-docs.readthedocs.io/en/latest/index.html.

---

## Examples

Examples are provided in the `input/` and `interface/` folders:

- `graphene.xyz` – periodic graphene sheet
- `water.xyz` – water molecule
- `inputfile.inp` – example Packmol input
- `md.inp` – simulation settings for xTB

To generate the full simulation:

```bash
# Optimize geometries
xtb input/graphene.xyz --opt --gfnff
xtb input/water.xyz --opt --gfnff

# Create interface
packmol < inputfile.inp

# Launch simulation
xtb interfaz.xyz --input md.inp --md
```
---


## License

This project is licensed under the **GNU GENERAL PUBLIC LICENSE v3.0**.

---

## Author

Rosell Martín Gómez  
Universidad de Extremadura – Facultad de Ciencias  
Departamento de Química Física e Ingeniería Química
